# wipetrash

**wipetrash** — это набор bash-скриптов для безопасной и безвозвратной очистки корзин (Trash) и истории «Недавние файлы».

## Возможности

- Автоматический поиск всех корзин пользователя (в том числе на внешних устройствах и других разделах).
- Безвозвратное удаление содержимого корзин с помощью `wipe` (или `rm`, если wipe не установлен).
- Очистка истории «Недавние файлы» (`recently-used.xbel`).
- Проверка и восстановление структуры корзин.
- Удобное TUI-меню с выбором действия.
- Создание ярлыка (`.desktop`) для запуска из меню приложений.

## Установка

1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/giteed/wipetrash.git
   cd wipetrash
   ```

2. Запустите автонастройку:
   ```bash
   bash setup_wt.sh
   ```
   Скрипт автоматически найдет все корзины и создаст конфиг, а также ярлык для меню приложений.

3. (Опционально) Установите wipe:
   ```bash
   sudo apt-get update && sudo apt-get install -y wipe
   ```
   Если `wipe` не установлен — будет использоваться обычное удаление через `rm`.

## Использование

### Быстрый запуск из терминала

```bash
bash wipe_trash.sh
```

### Возможные действия в меню

- **1** — Очистить все корзины и историю полностью.
- **2…n** — Очистить выбранную корзину.
- **Только history** — Очистить только историю «Недавние файлы».
- **r** — Проверить и починить структуру корзин.
- **h** — Справка.
- **q** — Выйти.

### Очистка без меню

Для быстрой полной очистки можно использовать движок напрямую:
```bash
bash clean_trash.sh
```

## Структура проекта

- `wipe_trash.sh` — основное меню для пользователя.
- `clean_trash.sh` — движок очистки.
- `setup_wt.sh` — авто-поиск корзин, генерация конфига и ярлыка.
- `trash_locations.conf` — автогенерируемый список корзин.
- `Burn_Folder_128x128_43380.png` — иконка для ярлыка.
- `add_safe_dir.sh` — **интерактивное добавление «безопасных» каталогов** (см. ниже).

---

## Новый скрипт: `add_safe_dir.sh`

Этот скрипт позволяет добавить абсолютные пути к каталогам, которые следует очищать, в файл конфигурации `trash_locations.conf`. Запустите его так:

```bash
chmod +x add_safe_dir.sh
./add_safe_dir.sh
```

Или выберите соответствующий пункт меню (например, клавишу `a`) в `wipe_trash.sh`, если он добавлен.

**Что делает скрипт:**
1. Создаёт резервную копию текущего `trash_locations.conf`.
2. Просит ввести абсолютные пути к каталогам для добавления в конфиг.
3. Проверяет существование каталога и отсутствие его в списке.
4. Добавляет строку вида `/полный/путь|/полный/путь|` (без info).
5. Остановить ввод можно нажатием Enter на пустой строке или введя `q`.

> После добавления новых каталогов перезапустите `wipe_trash.sh` — изменения сразу появятся в списке для очистки.

---

## Требования

- bash 4+
- Для полного удаления рекомендуется пакет `wipe`.
- Для работы ярлыка: Linux Desktop Environment (например, GNOME, KDE).

## Советы

- Внешние и съемные носители должны быть подключены для обнаружения их корзин при запуске `setup_wt.sh`.
- Рекомендуется запускать очистку с правами обычного пользователя (НЕ через sudo!).

## Лицензия

MIT
